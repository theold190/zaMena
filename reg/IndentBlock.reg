REGEDIT4

[HKEY_CURRENT_USER\Software\far2\KeyMacros\Editor\i]
"Sequence"="$If(!Selected)   $AKey $Else   editor.undo(0);   Eval(%%GetInitialPosition)    $If(%startLine==%endLine)     $AKey     editor.undo(0);     $Exit   $End    editor.sel(4);    %tabSize=-1;   Eval(%%GetTabSize)    $If(%endColumn==0 && %startLine!=%endLine)     %endLine=%endLine-1;   $End    %iterStart=%startLine;   %iterEnd=%endLine;   %column=0;    $While(%iterStart < %iterEnd)      editor.pos(1,1,%iterStart);     %openBracket=index(substr(Editor.Value,%column), \"{\");     $While(%openBracket == -1 && %iterStart <= %iterEnd)       %iterStart=%iterStart+1;       %column=0;       editor.pos(1,1,%iterStart);       %openBracket=index(Editor.Value, \"{\");     $End     %openBracket=%openBracket+%column;      %findClosingBracket_lineStart=%iterStart;     %findClosingBracket_lineEnd=%iterEnd;     %findClosingBracket_columnOpen=%openBracket;     Eval(%%FindClosingBracket)     %iter=%findClosingBracket_resultLine;      %comment=\"Use %%FormatCodeBlock mini-macro, ignore one line blocks\";     $If(%iterStart < %iter)       %startFormatLine=%iterStart;       %endFormatLine=%iter;       Eval(%%FormatCodeBlock)     $End         %column = %openBracket+1;   $End    editor.pos(1,2,%positionColumn);   editor.pos(1,1,%positionLine);    editor.undo(1); $End"
"DisableOutput"=dword:00000001
"Description"="Formats selected block of code"
