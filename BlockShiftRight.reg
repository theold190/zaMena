REGEDIT4

[HKEY_CURRENT_USER\Software\far2\KeyMacros\Editor\Tab]
"Sequence"="$If(!Selected)   $AKey $Else   editor.undo(0);   %positionLine=editor.pos(0,1);   %positionColumn=editor.pos(0,2);    %startLine=editor.sel(0,0);   %startColumn=editor.sel(0,1);   %endLine=editor.sel(0,2);   %endColumn=editor.sel(0,3);   %iter=%startLine;   %tabSize=-1;    $If(%endColumn==0 && %startLine!=%endLine)     %endLine=%endLine-1;   $End    editor.sel(4);    $While(%iter<=%endLine)     editor.pos(1,1,%iter);     editor.pos(1,2,1);     %buff=Editor.Value;     $If(len(%buff)!=0)       $if(len(trim(%buff))!=0)         Tab       $End       print(trim(%buff,2)); Enter CtrlY       $If(%tabSize<0)         Up         %buff2=Editor.Value;         %tabSize=len(%buff2)-len(%buff);       $End     $End     %iter=%iter+1;   $End    $If(%tabSize<0)     %tabSize=0;   $End    $If(%endColumn==0)     editor.pos(1,2,%startColumn);     editor.pos(1,1,%startLine);     editor.sel(2,0);      editor.pos(1,2,%startColumn);     editor.pos(1,1,%endLine+1);     editor.sel(2,1);      editor.pos(1,2,%startColumn);     editor.pos(1,1,%positionLine);   $Else     editor.pos(1,2,%startColumn+%tabSize);     editor.pos(1,1,%startLine);     editor.sel(2,0);      editor.pos(1,2,%endColumn+1+%tabSize);     editor.pos(1,1,%endLine);     editor.sel(2,1);      editor.pos(1,2,%positionColumn+%tabSize);     editor.pos(1,1,%positionLine);   $End    editor.undo(1); $End"
"DisableOutput"=dword:00000001